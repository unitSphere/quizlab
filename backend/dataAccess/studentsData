const executeQuery = require('../utilities/mongoConnect').executeQuery;
const db = "Quizlab";
const collection = "students";
let ObjectId = require('mongodb').ObjectID;


exports.add_student = async (student) => {
    return await executeQuery(db, async (db) => await db.collection(collection).insertOne(
        {name: student.name, surname: student.surname, email: student.email, password: student.password, salt: student.salt}));
};

// exports.user_signin = async (username, password) => {
//     return await executeQuery(db, async (db) => await db.collection(users_collection).findOne(
//         {username: username, password: password}));
// };

exports.get_students = async () => {
    return await executeQuery(db, async (db) => await db.collection(collection).find({}).toArray());
};

exports.find_student_by_email = async (email) => {
    return await executeQuery(db, async (db) => await db.collection(collection).findOne(
        {email: email}));
};

exports.get_students_by_ids = async (student_ids) => {
    student_ids.forEach((id, index, student_ids) => student_ids[index] = ObjectId(id));
    console.log(student_ids);
    return await executeQuery(db, async (db) => await db.collection(collection).find({"_id" : {"$in" : student_ids}}).toArray())
}